---
# Reset tasks for host_prepare role
# Note: We intentionally do NOT undo OS updates or remove common packages
# This role is designed to be idempotent and safe

- name: Display reset message
  debug:
    msg: "host_prepare reset does not remove OS updates or packages - these are intentionally persistent"

- name: Check if VM storage path is in use
  shell: |
    lsctl -n {{ vm_storage_path }}
  register: vm_storage_usage
  changed_when: false
  failed_when: false

- name: Display VM storage usage warning
  debug:
    msg: "WARNING: VM storage path {{ vm_storage_path }} is in use - manual cleanup required if needed"
  when: vm_storage_usage.stdout_lines | length > 0
